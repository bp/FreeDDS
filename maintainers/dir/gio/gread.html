<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Data Dictionary System: Maintainers Directories (gio - gread)
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <meta name="keywords" content="Data Dictionary System Free Seismic Processing System">
    <link href="../../../styles.css" type="text/css" rel="stylesheet">
    <script src="../../../javascript.js" language="JavaScript"
      type="text/javascript"></script>
    <script src="../index.js" language="JavaScript" type="text/javascript">
    </script>
  </head>
  <body>
    <script type="text/javascript">
      header("maintainers","dir","gio","gread")
    </script>
    <!*********************************************************************>
    <script type="text/javascript">index_header("gio")</script><h2>

    <h2>greada, greadb, greadc, greadm, gunread - stream input</h2>
    <hr>
    <h2>SYNOPSIS</h2>
    <b>#include "gio.h"</b><br/>

    <b>int greadc(GFILE *</b><i>stream</i><b>, void *</b><i>buf
    </i><b>, size_t </b><i>size</i><b>);</b><br/>
    
    <b>int greadm(GFILE *</b><i>stream</i><b>, void **</b><i>buf
    </i><b>, size_t </b><i>size</i><b>);</b><br/>
    
    <b>int greada(GFILE *</b><i>stream</i><b>, void **</b><i>buf
    </i><b>, size_t </b><i>size</i><b>, GIO_ALIGN </b><i>align</i><b>);
    </b><br/>
    
    <b>int greadb(GFILE *</b><i>stream</i><b>, void **</b><i>buf
    </i><b>, size_t </b><i>size</i><b>, GIO_ALIGN </b><i>align
    </i><b>, size_t </b><i>bias</i><b>);</b><br/>
    
    <b>int gunread(GFILE *</b><i>stream</i><b>, const void *</b><i>buf
    </i><b>, size_t </b><i>size</i><b>);</b>

    <h2>DESCRIPTION</h2>
    <b>greadc</b> is called to read data from the i/o stream referenced by
    <i>stream</i>. Up to <i>size </i> bytes are read into
    a buffer provided by the caller, beginning at <i>buf</i>.

    <p/>
    <b>greadm</b> is called to read data from the i/o stream referenced by
    <i>stream</i>. The function reserves buffer space for at least 
    <i>size</i>bytes of data.
    The buffer alignment is suitable for any host data type,
    like pointers returned by <b>malloc</b>.
    A pointer to the buffer is assigned to <b>*</b><i>buf</i>.
    The buffer may be accessed read-only, until the next operation on
    <i>stream</i>. Behavior is undefined,
    if the caller attempts to modify the buffer contents.

    <p/>
    <b>greada</b> is similar to <b>greadm</b>,  except for buffer alignment.
    The minimum alignment is specified by <i>align</i> (GIO_CHAR, GIO_SHORT,
      GIO_INT, etc.).
    The values required for various types are defined in "gio.h"
    and describe in <b>gio</b>. If <i>align</i> equals <b>GIO_MALLOC</b>,
    then the call is functionally equivalent to <b>greadm</b>.

    <p/>
    <b>greadb</b> is similar to <b>greada</b>, except for an alignment
    <i>bias</i>. The alignment is associated with
    <b>((char*)</b><i>*buf</i><b>+</b><i>bias</i><b>)</b>
    instead of the beginning of the buffer.
    This variation can accommidate weird composite transfers,
    i.e. "short" prefix on an array of "double" values.

    <p/>
    <b>gunread</b> is called to queue data for subsequent reads on the 
      i/o stream referenced by <i>stream</i>.
    <i>Size</i> bytes are queued from a buffer provided by the caller,
    beginning at <i>buf</i>.
    The actual stream position and contents are not changed.
    Any existing queue contents are discarded,
    when any write, unread, or reposition operation is performed on
    <i>stream</i>. If the stream is non-buffered and data is queued,
    then the entire queue is consumed by the next read.

    <h2>RETURN VALUES</h2>
    If positive, the function return value is the number of bytes
    actually read.
    The current file position is incremented by this amount.
    If the return value is less than the number of bytes requested,
    then an error or EOF was encountered.
    If the return value is zero, <b>*</b><i>buf</i> is undefined, and
    no data was transferred.
    <b>gerror</b> and <b>geof</b> may be called to determine the current status.

    <p/>
    <b>unread</b> returns the number of bytes actually queued,
    and doesn't change the file position. 

    <h2>ERRORS</h2>
    Potential errors are defined by <b>read</b>(2), <b>mmap</b>(2).

    <h2>BUGS</h2>
    Read and write can be intermixed,
    with or without intervening file position requests.
    Applications may break, if converted to <b>stdio</b>,
    where such sequences are undefined.

    <p/>
    When reading 8mm tapes, the requested size
    should be greater than or equal to the physical record length.
    The SunOS kernel (4.1.3_U1) will return errno 22 (Invalid argument)
    if the requested size is less than the physical tape record.
    This problem was first noted 13 Feb 1996 by Jerry Ehlers.
    It unknown whether this problem occurs on other hosts or tape device.

    <h2>EXAMPLE</h2>
<pre>
{  /* read 80 bytes, into a char buffer */
    GFILE *fp; char *buf; int n;
    n = greada(fp, &amp;buf, 80, GIO_CHAR);
}

{  /* read 200 gpos_t structures */
    GFILE *fp; gpos_t *buf; int n;
    n = greada(fp, &amp;buf, 200 * sizeof(gpos_t), GIO_MALLOC);
}

{  /* read and write, with minimal data copying */
    GFILE *fp_in, *fp_out; const char *buf; int n;
    while(0 &lt; (n = greada(fp_in, &amp;buf, 32 * 1024, GIO_CHAR)))
    gwritec(fp_out, buf, n);
}

{  /* unread three characters, for subsequent input */
    GFILE *fp;
    gunread(fp, "abc", 3);
}
</pre>

    <h2>FILES</h2>
    $DDSROOT/include/gio.h<br/>
    $DDSROOT/lib/$TARCH/libgio.a

    <h2>AUTHOR</h2>
    R. L. Selzler, <b>EPTG</b> (Oct 1995)

    <h2>REFERENCES</h2>
    1. Orran Krieger and Michael Stumm,
    "The Alloc Stream Facility, A Redesign of Application-Level Stream I/O"
    IEEE Computer, Vol. 27, No. 3, Mar. 1994, pp. 75-82.

    <script type="text/javascript">index_footer()</script>
    <!*********************************************************************>
    <script type="text/javascript">footer()</script>
  </body>
</html>
