c***********************************************************************
c                     B P   A M E R I C A
c             PROPRIETARY - TO BE MAINTAINED IN CONFIDENCE 
c                           COPYRIGHTED 2005
c***********************************************************************
c
c     Given the integer input, N, the function returns the integer
c     M such that M is the smallest number greater than or equeal to
c     N such that M = 2**K1 * 3**K2 * 5**K3 * 7**K4 * 11**K5 * 13**K6
c     where K1 is a positive integer and K2, K3, K4, K5 & K6 are
c     non-negative integer.
c
c     written: May  1988 R.D. Coleman, QTC
c     modified: May 2002 J.W. Ehlers, BP
c
      INTEGER FUNCTION FFT_NRFFT5(N)
C
      INTEGER  N
C
      INTEGER  I,I1,I2,M,ITMP,ITEST
C
      INTEGER  MAX
#ifdef ppc64
      PARAMETER(MAX = 451)
      INTEGER  NUM(MAX)
      DATA     NUM /
     &      2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 28, 30, 32, 36,
     &     40, 42, 44, 48, 56, 60, 64, 66, 70, 72, 80, 84, 88, 90, 96,
     &    110, 112, 120, 126, 128, 132, 140, 144, 154, 160, 168, 176,
     &    180, 192, 198, 210, 220, 224, 240, 252, 256, 264, 280, 288,
     &    308, 320, 330, 336, 352, 360, 384, 396, 420, 440, 448, 462,
     &    480, 504, 512, 528, 560, 576, 616, 630, 640, 660, 672, 704,
     &    720, 768, 770, 792, 840, 880, 896, 924, 960, 990, 1008, 1024,
     &   1056, 1120, 1152, 1232, 1260, 1280, 1320, 1344, 1386, 1408,
     &   1440, 1536, 1540, 1584, 1680, 1760, 1792, 1848, 1920, 1980,
     &   2016, 2048, 2112, 2240, 2304, 2310, 2464, 2520, 2560, 2640,
     &   2688, 2772, 2816, 2880, 3072, 3080, 3168, 3360, 3520, 3584,
     &   3696, 3840, 3960, 4032, 4096, 4224, 4480, 4608, 4620, 4928,
     &   5040, 5120, 5280, 5376, 5544, 5632, 5760, 6144, 6160, 6336,
     &   6720, 6930, 7040, 7168, 7392, 7680, 7920, 8064, 8192, 8448,
     &   8960, 9216, 9240, 9856, 10080, 10240, 10560, 10752, 11088,
     &  11264, 11520, 12288, 12320, 12672, 13440, 13860, 14080, 14336,
     &  14784, 15360, 15840, 16128, 16384, 16896, 17920, 18432, 18480,
     &  19712, 20160, 20480, 21120, 21504, 22176, 22528, 23040, 24576,
     &  24640, 25344, 26880, 27720, 28160, 28672, 29568, 30720, 31680,
     &  32256, 32768, 33792, 35840, 36864, 36960, 39424, 40320, 40960,
     &  42240, 43008, 44352, 45056, 46080, 49152, 49280, 50688, 53760,
     &  55440, 56320, 57344, 59136, 61440, 63360, 64512, 65536, 67584,
     &  71680, 73728, 73920, 78848, 80640, 81920, 84480, 86016, 88704,
     &  90112, 92160, 98304, 98560, 101376, 107520, 110880, 112640,
     & 114688, 118272, 122880, 126720, 129024, 131072, 135168, 143360,
     & 147456, 147840, 157696, 161280, 163840, 168960, 172032, 177408,
     & 180224, 184320, 196608, 197120, 202752, 215040, 221760, 225280,
     & 229376, 236544, 245760, 253440, 258048, 262144, 270336, 286720,
     & 294912, 295680, 315392, 322560, 327680, 337920, 344064, 354816,
     & 360448, 368640, 393216, 394240, 405504, 430080, 443520, 450560,
     & 458752, 473088, 491520, 506880, 516096, 524288, 540672, 573440,
     & 589824, 591360, 630784, 645120, 655360, 675840, 688128, 709632,
     & 720896, 737280, 786432, 788480, 811008, 860160, 887040, 901120,
     & 917504, 946176, 983040, 1013760, 1032192, 1048576, 1081344,
     & 1146880, 1179648, 1182720, 1261568, 1290240, 1310720, 1351680,
     & 1376256, 1419264, 1441792, 1474560, 1572864, 1576960, 1622016,
     & 1720320, 1774080, 1802240, 1835008, 1892352, 1966080, 2027520,
     & 2064384, 2097152, 2162688, 2293760, 2359296, 2365440, 2523136,
     & 2580480, 2621440, 2703360, 2752512, 2838528, 2883584, 2949120,
     & 3145728, 3153920, 3244032, 3440640, 3548160, 3604480, 3670016,
     & 3784704, 3932160, 4055040, 4128768, 4194304, 4325376, 4587520,
     & 4718592, 4730880, 5046272, 5160960, 5242880, 5406720, 5505024,
     & 5677056, 5767168, 5898240, 6291456, 6307840, 6488064, 6881280,
     & 7096320, 7208960, 7340032, 7569408, 7864320, 8110080, 8257536,
     & 8388608, 8650752, 9175040, 9437184, 9461760, 10092544, 10321920,
     & 10485760, 10813440, 11010048, 11354112, 11534336, 11796480,
     & 12582912, 12615680, 12976128, 13762560, 14192640, 14417920,
     & 14680064, 15138816, 15728640, 16220160, 16515072, 16777216,
     & 17301504, 18350080, 18874368, 18923520, 20185088, 20643840,
     & 20971520, 21626880, 22020096, 22708224, 23068672, 23592960,
     & 25165824, 25231360, 25952256, 27525120, 28385280, 28835840,
     & 29360128, 30277632, 31457280, 32440320, 33030144, 33554432,
     & 34603008, 36700160, 37748736 /
#else
#ifdef FULLPWR2
      PARAMETER(MAX = 137)
      INTEGER  NUM(MAX)
      DATA     NUM /
     &        2,    4,    6,    8,   10,   12,   16,   18,   20,   24,
     &       30,   32,   36,   40,   48,   50,   54,   60,   64,   72,
     &       80,   90,   96,  100,  108,  120,  128,  144,  150,  160,
     &      162,  180,  192,  200,  216,  240,  250,  256,  270,  288,
     &      300,  320,  324,  360,  384,  400,  432,  450,  480,  486,
     &      500,  512,  540,  576,  600,  640,  648,  720,  750,  768,
     &      800,  810,  864,  900,  960,  972, 1000, 1024, 1080, 1152,
     &     1200, 1250, 1280, 1296, 1350, 1440, 1458, 1500, 1536, 1600,
     &     1620, 1728, 1800, 1920, 1944, 2000, 2048, 2160, 2250, 2304,
     &     2400, 2430, 2500, 2560, 2592, 2700, 2880, 2916, 3000, 3072,
     &     3200, 3240, 3456, 3600, 3750, 3840, 3888, 4000, 4050, 4096,
     &     4320, 4374, 4500, 4608, 4800, 4860, 5000, 5120, 5184, 5400,
     &     5760, 5832, 6000, 6144, 6250, 6400, 6480, 6750, 6912, 7200,
     &     7290, 7500, 7680, 7776, 8000, 8100, 8192/
#else
      PARAMETER(MAX = 537)
      INTEGER  NUM(MAX)
      DATA     NUM /
     &    2,    4,    6,    8,   10,   12,   14,   16,   18,   20,
     &   22,   24,   26,   28,   30,   32,   36,   40,   42,   44,
     &   48,   50,   52,   54,   56,   60,   64,   66,   70,   72,
     &   78,   80,   84,   88,   90,   96,   98,  100,  104,  108,
     &  110,  112,  120,  126,  128,  130,  132,  140,  144,  150,
     &  154,  156,  160,  162,  168,  176,  180,  182,  192,  196,
     &  198,  200,  208,  210,  216,  220,  224,  234,  240,  242,
     &  250,  252,  256,  260,  264,  270,  280,  286,  288,  294,
     &  300,  308,  312,  320,  324,  330,  336,  338,  350,  352,
     &  360,  364,  378,  384,  390,  392,  396,  400,  416,  420,
     &  432,  440,  448,  450,  462,  468,  480,  484,  486,  490,
     &  500,  504,  512,  520,  528,  540,  546,  550,  560,  572,
     &  576,  588,  594,  600,  616,  624,  630,  640,  648,  650,
     &  660,  672,  676,  686,  700,  702,  704,  720,  726,  728,
     &  750,  756,  768,  770,  780,  784,  792,  800,  810,  832,
     &  840,  858,  864,  880,  882,  896,  900,  910,  924,  936,
     &  960,  968,  972,  980,  990, 1000, 1008, 1014, 1024, 1040,
     & 1050, 1056, 1078, 1080, 1092, 1100, 1120, 1134, 1144, 1152,
     & 1170, 1176, 1188, 1200, 1210, 1232, 1248, 1250, 1260, 1274,
     & 1280, 1296, 1300, 1320, 1344, 1350, 1352, 1372, 1386, 1400,
     & 1404, 1408, 1430, 1440, 1452, 1456, 1458, 1470, 1500, 1512,
     & 1536, 1540, 1560, 1568, 1584, 1600, 1620, 1638, 1650, 1664,
     & 1680, 1690, 1694, 1716, 1728, 1750, 1760, 1764, 1782, 1792,
     & 1800, 1820, 1848, 1872, 1890, 1920, 1936, 1944, 1950, 1960,
     & 1980, 2000, 2002, 2016, 2028, 2048, 2058, 2080, 2100, 2106,
     & 2112, 2156, 2160, 2178, 2184, 2200, 2240, 2250, 2268, 2288,
     & 2304, 2310, 2340, 2352, 2366, 2376, 2400, 2420, 2430, 2450,
     & 2464, 2496, 2500, 2520, 2548, 2560, 2574, 2592, 2600, 2640,
     & 2646, 2662, 2688, 2700, 2704, 2730, 2744, 2750, 2772, 2800,
     & 2808, 2816, 2860, 2880, 2904, 2912, 2916, 2940, 2970, 3000,
     & 3024, 3042, 3072, 3080, 3120, 3136, 3146, 3150, 3168, 3200,
     & 3234, 3240, 3250, 3276, 3300, 3328, 3360, 3380, 3388, 3402,
     & 3430, 3432, 3456, 3500, 3510, 3520, 3528, 3564, 3584, 3600,
     & 3630, 3640, 3696, 3718, 3744, 3750, 3780, 3822, 3840, 3850,
     & 3872, 3888, 3900, 3920, 3960, 4000, 4004, 4032, 4050, 4056,
     & 4096, 4116, 4158, 4160, 4200, 4212, 4224, 4290, 4312, 4320,
     & 4356, 4368, 4374, 4394, 4400, 4410, 4480, 4500, 4536, 4550,
     & 4576, 4608, 4620, 4680, 4704, 4732, 4752, 4800, 4802, 4840,
     & 4860, 4900, 4914, 4928, 4950, 4992, 5000, 5040, 5070, 5082,
     & 5096, 5120, 5148, 5184, 5200, 5250, 5280, 5292, 5324, 5346,
     & 5376, 5390, 5400, 5408, 5460, 5488, 5500, 5544, 5600, 5616,
     & 5632, 5670, 5720, 5760, 5808, 5824, 5832, 5850, 5880, 5940,
     & 6000, 6006, 6048, 6050, 6084, 6144, 6160, 6174, 6240, 6250,
     & 6272, 6292, 6300, 6318, 6336, 6370, 6400, 6468, 6480, 6500,
     & 6534, 6552, 6600, 6656, 6720, 6750, 6760, 6776, 6804, 6860,
     & 6864, 6912, 6930, 7000, 7020, 7040, 7056, 7098, 7128, 7150,
     & 7168, 7200, 7260, 7280, 7290, 7350, 7392, 7436, 7488, 7500,
     & 7546, 7560, 7644, 7680, 7700, 7722, 7744, 7776, 7800, 7840,
     & 7920, 7938, 7986, 8000, 8008, 8064, 8100, 8112, 8190, 8192,
     & 8232, 8250, 8316, 8320, 8400, 8424, 8448, 8450, 8470, 8580,
     & 8624, 8640, 8712, 8736, 8748, 8750, 8788, 8800, 8820, 8910,
     & 8918, 8960, 9000, 9072, 9100, 9126, 9152, 9216, 9240, 9360,
     & 9408, 9438, 9450, 9464, 9504, 9600, 9604, 9680, 9702, 9720,
     & 9750, 9800, 9828, 9856, 9900, 9984, 10000/
#endif
#endif
C
C-----------------------------------------------------------------------
C
C     Use table
C
      IF (N.LE.NUM(MAX)) THEN
         I1 = 0
         I2 = MAX
         DO WHILE(I2.GT.I1+1)
            I = (I1 + I2) / 2
            M = NUM(I)
            IF (M.LT.N) THEN
               I1 = I
            ELSEIF (M.GT.N) THEN
               I2 = I
            ELSE
               FFT_NRFFT5 = M
               RETURN
            ENDIF
         ENDDO
         M = NUM(I2)
         FFT_NRFFT5 = M
         RETURN
      ENDIF
C
C     Calculate it
C
      M = N - 2 + MOD(N,2)
      ITMP = M
      DO WHILE(ITMP.NE.1)
         M = M + 2
         ITMP = M
C     
         ITEST = ITMP/2
         DO WHILE(2*ITEST.EQ.ITMP)
            ITMP  = ITEST
            ITEST = ITMP/2
         ENDDO
C     
         ITEST = ITMP/3
         DO WHILE(3*ITEST.EQ.ITMP)
            ITMP  = ITEST
            ITEST = ITMP/3
         ENDDO
C     
         ITEST = ITMP/5
         DO WHILE(5*ITEST.EQ.ITMP)
            ITMP  = ITEST
            ITEST = ITMP/5
         ENDDO
      ENDDO
C
      FFT_NRFFT5 = M
C
      RETURN
      END
